(this["webpackJsonpspotify-lyrics"]=this["webpackJsonpspotify-lyrics"]||[]).push([[0],{41:function(e,t,a){e.exports=a(81)},46:function(e,t,a){},81:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(16),o=a.n(c),i=(a(46),a(19)),s=a(12),l=a(8),u=a(10),m=a(38),p=a(39),d={auth:{SPOTIFY_LOGIN_SUCCESS:"SPOTIFY_LOGIN_SUCCESS",SPOTIFY_LOGIN_FAILURE:"SPOITFY_LOGIN_FAILURE",GENIUS_LOGIN_SUCCESS:"GENIUS_LOGIN_SUCCESS",GENIUS_LOGIN_FAILURE:"GENIUS_LOGIN_FAILURE"}};function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function f(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(a,!0).forEach((function(t){Object(p.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var h={spotifyLoggedIn:!1,spotifyToken:null,spotifyExpiry:null,geniusLoggedIn:!1,geniusToken:null},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d.auth.SPOTIFY_LOGIN_SUCCESS:var a=new Date,n=Math.round(a.getTime()/1e3)+parseInt(t.payload.expires_in);return f({},e,{spotifyLoggedIn:!0,spotifyToken:t.payload.access_token,spotifyExpiry:n});case d.auth.SPOTIFY_LOGIN_FAILURE:return f({},e,{spotifyLoggedIn:!1,spotifyToken:null,spotifyExpiry:null});case d.auth.GENIUS_LOGIN_SUCCESS:return f({},e,{geniusLoggedIn:!0,geniusToken:t.payload.access_token});case d.auth.GENIUS_LOGIN_FAILURE:return f({},e,{geniusLoggedIn:!1,geniusToken:null});default:return e}},E=Object(u.c)({auth:y}),O=[m.a],I=Object(u.e)(E,{},Object(u.d)(u.a.apply(void 0,O),window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__():function(e){return e})),b=a(13),S=a(11),_=a.n(S),L=function(e){return{auth:e.auth}},N={margin:"0.5rem"},v=Object(l.b)(L,{})((function(e){var t=e.auth,a="https://api.genius.com/oauth/authorize?response_type=token&client_id=".concat("zUMPy5LKiEsgfmetAo-pABlZEklcFEPAJEqQha7tmsA2QGfbNY-gOmj-u7k6QZY9","&redirect_uri=").concat("http://localhost:3001/callback-genius","&scope=").concat("me");return r.a.createElement("button",{style:N,className:"btn btn-warning",onClick:function(){window.location.href=a},disabled:t.geniusLoggedIn},t.geniusLoggedIn?"Genius Connected":"Log in to Genius")})),w=Object(l.b)(L,{})((function(e){var t=e.auth,a="https://accounts.spotify.com/authorize?response_type=token&client_id=".concat("7327839d168a4f87a29de25dbf165fb0","&redirect_uri=").concat("http://localhost:3001/callback-spotify","&scope=").concat("user-read-playback-state");return r.a.createElement("button",{style:N,className:"btn btn-success",onClick:function(){window.location.href=a},disabled:t.spotifyLoggedIn},t.spotifyLoggedIn?"Spotify Connected":"Log in to Spotify")})),G=function(){return r.a.createElement("nav",{className:"navbar navbar-collapse-sm justify-content-between",style:{padding:"1rem"}},r.a.createElement("h1",{className:"navbar-brand"},"Spotify Lyrics"))},U=function(e){var t=e.children;return r.a.createElement(r.a.Fragment,null,r.a.createElement(G,null),r.a.createElement("main",null,t))},k=a(21),j=a(23);function F(e){var t=e.song,a=t&&t.item.album.images[1],n=t&&t.item.artists[0].name,c=t&&t.item.album.name,o=t&&t.item.name,i=a&&a.url;return r.a.createElement("div",{className:"card text-white bg-secondary mb-3",style:{maxWidth:"25rem",marginLeft:"auto",marginRight:"auto",marginBottom:"1rem"}},r.a.createElement("div",{className:"card-header",style:{textAlign:"left"}},"Now Playing"),r.a.createElement("img",{style:{height:"200px",width:"200px",alignSelf:"center",marginTop:"20px",display:"block",borderRadius:"5px"},src:i,alt:"Card image"}),r.a.createElement("div",{className:"card-body"},r.a.createElement("h5",{className:"card-title"},o),r.a.createElement("h6",{className:"card-subtitle"},r.a.createElement(k.a,{style:{paddingRight:"0.25rem"},icon:j.b}),n),r.a.createElement("h6",{className:"card-subtitle",style:{marginTop:"0.3rem"}},r.a.createElement(k.a,{style:{paddingRight:"0.25rem"},icon:j.a}),c)))}function T(e){var t=e.lyrics;return r.a.createElement("div",{className:"card mb-3",style:{maxWidth:"25rem",marginLeft:"auto",marginRight:"auto",marginBottom:"1rem"}},r.a.createElement("div",{className:"card-header",style:{textAlign:"left"}},"Lyrics"),r.a.createElement("div",{className:"card-body"},t.isLyricsLoading?r.a.createElement("div",{className:"spinner-border text-warning",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")):r.a.createElement("p",{style:{whiteSpace:"pre-wrap",fontSize:"16px"}},t.lyrics)))}var C=Object(l.b)((function(e){return{auth:e.auth}}),{})((function(e){var t=e.song,a=e.auth,c=function(e,t){var a=Object(n.useState)(null),r=Object(b.a)(a,2),c=r[0],o=r[1],i=Object(n.useState)(null),s=Object(b.a)(i,2),l=s[0],u=s[1],m=Object(n.useState)(!1),p=Object(b.a)(m,2),d=p[0],g=p[1];return Object(n.useEffect)((function(){t&&t.geniusToken&&e&&e.item.id!==l&&(g(!0),document.title="Spotify Lyrics | ".concat(e.item.name," - ").concat(e.item.artists[0].name),_.a.get("https://api.genius.com/search?q=".concat(e.item.name,"-").concat(e.item.artists[0].name,"&access_token=").concat(t.geniusToken)).then((function(a){if(200===a.data.meta.status)if(u(e.item.id),a.data.response.hits[0]&&a.data.response.hits[0].result){var n="/api/lyrics/".concat(a.data.response.hits[0].result.id,"?genius_token=").concat(t.geniusToken);_.a.get(n).then((function(e){o(e.data),g(!1)}))}else o("No results found for this track"),g(!1)})))}),[e,t]),{isLyricsLoading:d,lyrics:c}}(t,a);return r.a.createElement("div",{style:{textAlign:"center"}},a.spotifyLoggedIn?r.a.createElement(r.a.Fragment,null,r.a.createElement(F,{song:t})):r.a.createElement(r.a.Fragment,null,r.a.createElement(w,null)),a.geniusLoggedIn?r.a.createElement(r.a.Fragment,null,r.a.createElement(T,{lyrics:c})):r.a.createElement(r.a.Fragment,null,r.a.createElement(v,null)))})),P=Object(l.b)((function(e){return{auth:e.auth}}),{})((function(e){var t=function(e){var t=Object(n.useState)(null),a=Object(b.a)(t,2),r=a[0],c=a[1],o=Object(n.useState)(null),i=Object(b.a)(o,2);i[0],i[1];return Object(n.useEffect)((function(){setInterval((function(){e.spotifyLoggedIn&&_.a.get("https://api.spotify.com/v1/me/player/currently-playing",{headers:{Authorization:"Bearer ".concat(e.spotifyToken),"Content-Type":"application/x-www-form-urlencoded"}}).then((function(e){200===e.status&&(null!==r&&r.item.id===e.data.item.id||c(e.data))})).catch((function(e){return console.log(e)}))}),1e3)}),[e.spotifyLoggedIn]),r}(e.auth);return r.a.createElement(U,null,r.a.createElement(C,{song:t}),"}")})),A=function(e){var t=e.handlerFunc,a=e.redirect;return t(e.location.hash),r.a.createElement(s.a,{to:a})},x=a(26),R=a.n(x),Y=function(){return function(e){var t=localStorage.getItem("spotify-auth");if(!t)return null;var a=JSON.parse(t);_.a.get("https://api.spotify.com/v1/me",{headers:{Authorization:"Bearer ".concat(a.access_token),"Content-Type":"application/x-www-form-urlencoded"}}).then((function(t){200===t.status?e({type:d.auth.SPOTIFY_LOGIN_SUCCESS,payload:a}):e({type:d.auth.SPOTIFY_LOGIN_FAILURE})})).catch((function(t){console.log(t),e({type:d.auth.SPOTIFY_LOGIN_FAILURE})}))}},D=function(){return function(e){var t=localStorage.getItem("genius-auth");if(!t)return null;var a=JSON.parse(t);_.a.get("https://api.genius.com/songs/378195?access_token=".concat(a.access_token)).then((function(t){200===t.status?e({type:d.auth.GENIUS_LOGIN_SUCCESS,payload:a}):e({type:d.auth.GENIUS_LOGIN_FAILURE})})).catch((function(t){console.log(t),e({type:d.auth.GENIUS_LOGIN_FAILURE})}))}},B=function(e){var t;I.dispatch((t=e,function(e){var a=R.a.parse(t);console.log(a),a.error?e({type:d.auth.SPOTIFY_LOGIN_FAILURE}):(localStorage.setItem("spotify-auth",JSON.stringify(a)),e({type:d.auth.SPOTIFY_LOGIN_SUCCESS,payload:a}))}))},J=function(e){var t;I.dispatch((t=e,function(e){var a=R.a.parse(t);console.log(a),a.error?e({type:d.auth.GENIUS_LOGIN_FAILURE}):(localStorage.setItem("genius-auth",JSON.stringify(a)),e({type:d.auth.GENIUS_LOGIN_SUCCESS,payload:a}))}))};var z=function(){return Object(n.useEffect)((function(){I.dispatch(Y()),I.dispatch(D())}),[]),r.a.createElement(l.a,{store:I},r.a.createElement(i.a,null,r.a.createElement(s.d,null,r.a.createElement(s.b,{exact:!0,path:"/",component:P}),r.a.createElement(s.b,{path:"/callback-spotify",render:function(e){return r.a.createElement(A,Object.assign({},e,{redirect:"/",handlerFunc:B}))}}),r.a.createElement(s.b,{path:"/callback-genius",render:function(e){return r.a.createElement(A,Object.assign({},e,{redirect:"/",handlerFunc:J}))}}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[41,1,2]]]);
//# sourceMappingURL=main.a43327dd.chunk.js.map